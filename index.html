<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Kitchen Escape</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            background: black;
            overflow: hidden;
        }

        /* IMDA REQUIRED WRAPPER */
        #container {
            width: 960px;
            height: 540px;
            position: relative;
            overflow: hidden;
        }

        /* GAME LIVES INSIDE CONTAINER */
        #game {
            width: 100%;
            height: 100%;
            position: relative;
            background: #000;
            overflow: hidden;
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Courier New', monospace; 
            background: #000;
        }
        
        .kitchen-bg { 
            width: 100%; 
            height: 100%; 
            position: relative; 
            background-image: url('kitchen-bg.png'); 
            background-size: cover; 
            background-position: center; 
        }
        
        .fridge { 
            position: absolute; 
            width: 200px; 
            height: 280px; 
            left: 50px; 
            top: 80px; 
            background: linear-gradient(135deg, #2a2a3e 0%, #1a1a2e 100%); 
            background-image: url('fridge.png'); 
            background-size: contain; 
            background-repeat: no-repeat; 
            background-position: center; 
            transition: all 0.5s ease; 
            z-index: 20; 
            cursor: pointer;
        }
        
        .fridge.active { 
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.8); 
            filter: brightness(1.2); 
            transform: scale(1.05); 
        }
        
        .oven { 
            position: absolute; 
            width: 250px; 
            height: 200px; 
            left: 320px; 
            bottom: 200px; 
            background: linear-gradient(135deg, #2a2a3e 0%, #1a1a2e 100%); 
            background-image: url('oven.png'); 
            background-size: contain; 
            background-repeat: no-repeat; 
            background-position: center; 
            transition: all 0.5s ease; 
            z-index: 20; 
            cursor: pointer;
        }
        
        .oven.active { 
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.8); 
            filter: brightness(1.2); 
            transform: scale(1.05); 
        }
        
        /* Portal Effect */
        .portal { 
            position: absolute; 
            width: 100px; 
            height: 220px; 
            right: 100px; 
            top: 110px; 
            display: none; 
            z-index: 15; 
            border-radius: 4px; 
            overflow: hidden; 
        }
        
        .portal.active { 
            display: block; 
            animation: portalAppear 1s ease-out; 
        }
        
        @keyframes portalAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .portal-inner { 
            width: 100%; 
            height: 100%; 
            background: linear-gradient(45deg, #ff0066, #00ffff, #00ff00, #ffaa00, #0066ff, #ff0066); 
            background-size: 400% 400%; 
            animation: portalSwirl 3s ease infinite; 
            box-shadow: 0 0 60px rgba(0, 255, 255, 0.8), inset 0 0 60px rgba(255, 255, 255, 0.3); 
        }
        
        @keyframes portalSwirl {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .door { 
            position: absolute; 
            width: 100px; 
            height: 220px; 
            right: 100px; 
            top: 110px; 
            background: linear-gradient(135deg, #3a2a2e 0%, #2a1a1e 100%); 
            border: 3px solid #4a3a3e; 
            border-radius: 4px; 
            transition: all 0.5s ease; 
            z-index: 20; 
            transform-origin: left center; 
        }
        
        .door.active { 
            border-color: #ff6600; 
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.8); 
        }
        
        .door.unlocked { 
            border-color: #00ff00; 
            box-shadow: 0 0 50px rgba(0, 255, 0, 1); 
            animation: doorOpen 2s ease-out forwards; 
        }
        
        @keyframes doorOpen {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(-90deg); opacity: 0; }
        }
        
        .door-handle { 
            width: 25px; 
            height: 6px; 
            background: #666; 
            position: absolute; 
            right: 15px; 
            top: 50%; 
            border-radius: 3px; 
        }
        
        #ai-avatar { 
            position: absolute; 
            left: 50%; 
            top: 30px; 
            transform: translateX(-50%); 
            width: 100px; 
            height: 100px; 
            background: rgba(0, 0, 0, 0.9); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 40px; 
            border: 3px solid #ffffff; 
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); 
            z-index: 50; 
        }
        
        #ai-avatar.system { border-color: #ffffff; color: #ffffff; }
        #ai-avatar.fridge { border-color: #ffffff; color: #ffffff; box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); }
        #ai-avatar.chef { border-color: #ffffff; color: #ffffff; box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); }
        #ai-avatar.chefbot { border-color: #ffffff; color: #ffffff; box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); }
        #ai-avatar.delivery { border-color: #ffffff; color: #ffffff; box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); }
        #ai-avatar.door-avatar { border-color: #ffffff; color: #ffffff; box-shadow: 0 0 30px rgba(255, 255, 255, 0.6); }
        
        #progress { 
            position: absolute; 
            top: 20px; 
            right: 20px; 
            background: rgba(0, 0, 0, 0.9); 
            color: #00ff00; 
            padding: 8px 16px; 
            border-radius: 6px; 
            font-size: 13px; 
            border: 2px solid #00ff00; 
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4); 
            display: none; 
            z-index: 60; 
        }
        
        #scene-title { 
            position: absolute; 
            top: 20px; 
            left: 20px; 
            color: #ff0066; 
            font-size: 14px; 
            font-weight: bold; 
            text-transform: uppercase; 
            background: rgba(0, 0, 0, 0.9); 
            padding: 8px 16px; 
            border-radius: 6px; 
            border: 2px solid #ff0066; 
            box-shadow: 0 0 15px rgba(255, 0, 100, 0.4); 
            max-width: 280px; 
            z-index: 60; 
        }
        
        /* Risk Score Display */
        #risk-score { 
            position: absolute; 
            top: 60px; 
            right: 20px; 
            background: rgba(0, 0, 0, 0.9); 
            padding: 8px 16px; 
            border-radius: 6px; 
            font-size: 13px; 
            border: 2px solid #00ff00; 
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4); 
            display: none; 
            z-index: 60; 
            transition: all 0.3s ease; 
        }
        
        #risk-score.low { 
            color: #00ff00; 
            border-color: #00ff00; 
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.4); 
        }
        
        #risk-score.medium { 
            color: #ffaa00; 
            border-color: #ffaa00; 
            box-shadow: 0 0 15px rgba(255, 170, 0, 0.4); 
        }
        
        #risk-score.high { 
            color: #ff0066; 
            border-color: #ff0066; 
            box-shadow: 0 0 15px rgba(255, 0, 100, 0.4); 
        }
        
        #dialogue-box { 
            position: absolute; 
            bottom: 20px; 
            left: 20px; 
            right: 20px; 
            background: rgba(0, 0, 0, 0.95); 
            border: 2px solid #00ffff; 
            border-radius: 10px; 
            padding: 18px; 
            max-height: 240px; 
            overflow-y: auto; 
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.3); 
            z-index: 60; 
        }
        
        #speaker-name { 
            color: #00ffff; 
            font-weight: bold; 
            font-size: 15px; 
            margin-bottom: 8px; 
            text-transform: uppercase; 
        }
        
        #dialogue-text { 
            color: #ffffff; 
            font-size: 13px; 
            line-height: 1.5; 
            margin-bottom: 12px; 
            white-space: pre-wrap; 
        }
        
        #choices { 
            display: flex; 
            flex-direction: column; 
            gap: 8px; 
        }
        
        .choice-btn { 
            background: rgba(0, 255, 255, 0.15); 
            color: #00ffff; 
            border: 2px solid #00ffff; 
            padding: 10px 14px; 
            border-radius: 6px; 
            font-size: 12px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            text-align: left; 
            font-family: 'Courier New', monospace; 
        }
        
        .choice-btn:hover { 
            background: rgba(0, 255, 255, 0.3); 
            transform: translateX(5px); 
        }
        
        .choice-btn.safe-flash { 
            background: #00ff00 !important; 
            color: #000 !important; 
            border-color: #00ff00 !important; 
            box-shadow: 0 0 30px rgba(0, 255, 0, 1) !important; 
        }
        
        .choice-btn.moderate-flash { 
            background: #ffaa00 !important; 
            color: #000 !important; 
            border-color: #ffaa00 !important; 
            box-shadow: 0 0 30px rgba(255, 170, 0, 1) !important; 
        }
        
        .choice-btn.risky-flash { 
            background: #ff0066 !important; 
            color: #fff !important; 
            border-color: #ff0066 !important; 
            box-shadow: 0 0 30px rgba(255, 0, 100, 1) !important; 
        }
        
        #feedback-modal { 
            display: none; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0, 0, 0, 0.97); 
            z-index: 100; 
            overflow-y: auto; 
            padding: 25px; 
        }
        
        #feedback-modal.active { 
            display: block; 
        }
        
        #feedback-content { 
            background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 100%); 
            border: 3px solid #ff0066; 
            border-radius: 10px; 
            padding: 22px; 
            max-width: 750px; 
            margin: 0 auto; 
            color: white; 
        }
        
        #feedback-content h2 { 
            color: #ff0066; 
            margin-bottom: 18px; 
            font-size: 18px; 
            text-align: center; 
            text-transform: uppercase; 
        }
        
        #feedback-content.safe { 
            border-color: #00ff00; 
            box-shadow: 0 0 35px rgba(0, 255, 0, 0.6); 
        }
        
        #feedback-content.safe h2 { 
            color: #00ff00; 
        }
        
        #feedback-content.moderate { 
            border-color: #ffaa00; 
            box-shadow: 0 0 35px rgba(255, 170, 0, 0.6); 
        }
        
        #feedback-content.moderate h2 { 
            color: #ffaa00; 
        }
        
        #feedback-content.risky { 
            border-color: #ff0066; 
            box-shadow: 0 0 35px rgba(255, 0, 100, 0.6); 
        }
        
        .feedback-icon { 
            font-size: 60px; 
            text-align: center; 
            margin-bottom: 15px; 
        }
        
        .safe-icon { color: #00ff00; }
        .moderate-icon { color: #ffaa00; }
        .risky-icon { color: #ff0066; }
        
        .feedback-section { 
            background: rgba(255, 0, 100, 0.1); 
            border-left: 4px solid #ff0066; 
            padding: 12px; 
            margin-bottom: 12px; 
            border-radius: 4px; 
        }
        
        .feedback-section h3 { 
            color: #ff0066; 
            font-size: 12px; 
            margin-bottom: 6px; 
            text-transform: uppercase; 
        }
        
        .feedback-section p { 
            color: #ffffff; 
            line-height: 1.5; 
            font-size: 11px; 
        }
        
        /* Safe feedback styling */
        #feedback-content.safe .feedback-section { 
            background: rgba(0, 255, 0, 0.1); 
            border-left-color: #00ff00; 
        }
        
        #feedback-content.safe .feedback-section h3 { 
            color: #00ff00; 
        }
        
        /* Moderate feedback styling */
        #feedback-content.moderate .feedback-section { 
            background: rgba(255, 170, 0, 0.1); 
            border-left-color: #ffaa00; 
        }
        
        #feedback-content.moderate .feedback-section h3 { 
            color: #ffaa00; 
        }
        
        .continue-btn { 
            display: block; 
            width: 160px; 
            margin: 18px auto 0; 
            background: linear-gradient(135deg, #ff0066 0%, #0066ff 100%); 
            color: white; 
            border: 2px solid #ff0066; 
            padding: 10px 20px; 
            border-radius: 6px; 
            font-size: 13px; 
            font-weight: bold; 
            cursor: pointer; 
            font-family: 'Courier New', monospace; 
            text-transform: uppercase; 
        }
        
        .continue-btn:hover { 
            transform: scale(1.05); 
        }
        
        #audio-toggle { 
            position: absolute; 
            top: 100px; 
            right: 20px; 
            background: rgba(0, 0, 0, 0.9); 
            color: #00ffff; 
            padding: 8px 16px; 
            border-radius: 6px; 
            font-size: 13px; 
            border: 2px solid #00ffff; 
            cursor: pointer; 
            z-index: 70; 
            font-family: 'Courier New', monospace; 
        }
        
        #audio-toggle:hover { 
            background: rgba(0, 255, 255, 0.2); 
        }
        
        /* Victory Room */
        #victory-room { 
            display: none; 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: linear-gradient(180deg, #1a1a2e 0%, #0a0a1e 50%, #000 100%); 
            z-index: 200; 
        }
        
        #victory-room.active { 
            display: block; 
            animation: fadeIn 1.5s ease-in; 
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .hallway { 
            width: 100%; 
            height: 100%; 
            position: relative; 
            background: linear-gradient(to bottom, rgba(26, 26, 46, 0.8) 0%, rgba(10, 10, 30, 0.9) 100%); 
        }
        
        .hallway-walls { 
            position: absolute; 
            width: 80%; 
            height: 70%; 
            left: 10%; 
            top: 15%; 
            background: linear-gradient(135deg, #2a2a3e 0%, #1a1a2e 100%); 
            clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%); 
            border: 3px solid #00ff00; 
            box-shadow: 0 0 50px rgba(0, 255, 0, 0.6); 
        }
        
        .exit-sign { 
            position: absolute; 
            top: 30px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: #00ff00; 
            color: #000; 
            padding: 10px 30px; 
            font-size: 20px; 
            font-weight: bold; 
            border-radius: 8px; 
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.8); 
            animation: glowPulse 2s infinite; 
            z-index: 5; 
        }
        
        @keyframes glowPulse {
            0%, 100% { box-shadow: 0 0 30px rgba(0, 255, 0, 0.8); }
            50% { box-shadow: 0 0 60px rgba(0, 255, 0, 1); }
        }
        
        .victory-text { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            text-align: center; 
            z-index: 10; 
        }
        
        .victory-title { 
            font-size: 44px; 
            color: #00ff00; 
            text-transform: uppercase; 
            margin-bottom: 20px; 
            animation: slideUp 1s ease-out, pulse 2s infinite 1s; 
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.8); 
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .victory-subtitle { 
            font-size: 18px; 
            color: #00ffff; 
            margin-bottom: 25px; 
            animation: slideUp 1s ease-out 0.3s both; 
        }
        
        .victory-message { 
            font-size: 14px; 
            color: #ffffff; 
            max-width: 600px; 
            margin: 0 auto 15px auto; 
            line-height: 1.6; 
            animation: slideUp 1s ease-out 0.6s both; 
        }
        
        .victory-score { 
            font-size: 20px; 
            color: #00ff00; 
            margin-bottom: 30px; 
            animation: slideUp 1s ease-out 0.8s both; 
            font-weight: bold; 
        }
        
        .restart-btn { 
            display: inline-block; 
            background: linear-gradient(135deg, #00ff00 0%, #00ffff 100%); 
            color: #000; 
            padding: 15px 40px; 
            border-radius: 8px; 
            font-size: 18px; 
            font-weight: bold; 
            cursor: pointer; 
            border: 3px solid #00ff00; 
            font-family: 'Courier New', monospace; 
            text-transform: uppercase; 
            animation: slideUp 1s ease-out 0.9s both; 
            transition: all 0.3s ease; 
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5); 
        }
        
        .restart-btn:hover { 
            transform: scale(1.1); 
            box-shadow: 0 0 40px rgba(0, 255, 0, 0.8); 
        }
        
        .confetti { 
            position: absolute; 
            width: 10px; 
            height: 10px; 
            background: #ff0066; 
            animation: fall 3s linear infinite; 
        }
        
        @keyframes fall {
            to { transform: translateY(600px) rotate(360deg); opacity: 0; }
        }
        
        .sparkle { 
            position: absolute; 
            width: 4px; 
            height: 4px; 
            background: #ffff00; 
            border-radius: 50%; 
            animation: sparkle 1.5s ease-in-out infinite; 
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1.5); }
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="game">
            <div class="kitchen-bg">
                <div class="fridge" id="fridge-el"></div>
                <div class="oven" id="oven-el"></div>
                <div class="portal" id="portal-el"><div class="portal-inner"></div></div>
                <div class="door" id="door-el"><div class="door-handle"></div></div>
            </div>

            <div id="ai-avatar" class="system">ðŸ¤–</div>
            <div id="progress"></div>
            <div id="risk-score">Risk: 0</div>
            <div id="scene-title"></div>

            <button id="audio-toggle">ðŸ”Š Music ON</button>

            <div id="dialogue-box">
                <div id="speaker-name"></div>
                <div id="dialogue-text"></div>
                <div id="choices"></div>
            </div>

            <div id="feedback-modal"><div id="feedback-content"></div></div>

            <!-- Victory Room -->
            <div id="victory-room">
                <div class="hallway">
                    <div class="hallway-walls"></div>
                    <div class="exit-sign">EXIT</div>

                    <div class="victory-text">
                        <div class="victory-title">ðŸŽ‰ YOU ESCAPED! ðŸŽ‰</div>
                        <div class="victory-subtitle">Congratulations! You've completed the Smart Kitchen Safety Protocol.</div>
                        <div class="victory-message">
                            You successfully navigated online safety challenges by questioning requests, maintaining boundaries, and protecting your personal information. Well done!
                        </div>
                        <div class="victory-score" id="final-score"></div>
                        <button class="restart-btn" onclick="restartGame()">ðŸ”„ PLAY AGAIN</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Background Music -->
    <audio id="bgMusic" loop>
        <source src="creepy_audio.mp3" type="audio/mpeg">
    </audio>
    
    <script>
// Audio control
var bgMusic = document.getElementById('bgMusic');
var audioToggle = document.getElementById('audio-toggle');
var musicPlaying = false;

bgMusic.volume = 1.0;

audioToggle.onclick = function() {
    if (musicPlaying) {
        bgMusic.pause();
        audioToggle.textContent = 'ðŸ”‡ Music OFF';
        musicPlaying = false;
    } else {
        bgMusic.play();
        audioToggle.textContent = 'ðŸ”Š Music ON';
        musicPlaying = true;
    }
};

// Try to autoplay
bgMusic.play().then(function() {
    musicPlaying = true;
    audioToggle.textContent = 'ðŸ”Š Music ON';
}).catch(function() {
    audioToggle.textContent = 'ðŸ”‡ Music OFF (Click to Start)';
});

// Risk Score System
var riskScore = 0;

function updateRiskScore(safety) {
    if (safety === 'safe') {
        // No risk added for safe choices
    } else if (safety === 'moderate') {
        riskScore += 5;
    } else if (safety === 'risky') {
        riskScore += 10;
    }
    
    var riskEl = document.getElementById('risk-score');
    riskEl.textContent = 'Risk: ' + riskScore;
    
    // Update color based on risk level
    riskEl.classList.remove('low', 'medium', 'high');
    if (riskScore <= 15) {
        riskEl.classList.add('low');
    } else if (riskScore <= 40) {
        riskEl.classList.add('medium');
    } else {
        riskEl.classList.add('high');
    }
}

function getRiskRating() {
    if (riskScore === 0) {
        return 'PERFECT! Zero Risk - Expert Level! ðŸ†';
    } else if (riskScore <= 15) {
        return 'Excellent! Low Risk - Well Done! â­â­â­';
    } else if (riskScore <= 40) {
        return 'Good! Medium Risk - Room for Improvement âš ï¸';
    } else {
        return 'Caution! High Risk - Practice More! âš ï¸âš ï¸';
    }
}

// Confetti and sparkles
function createConfetti() {
    var victoryRoom = document.getElementById('victory-room');
    var colors = ['#ff0066', '#00ff00', '#0066ff', '#ffaa00', '#ff6600', '#00ffff'];
    
    for (var i = 0; i < 50; i++) {
        var confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDelay = Math.random() * 3 + 's';
        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
        victoryRoom.appendChild(confetti);
    }
    
    for (var j = 0; j < 30; j++) {
        var sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.style.left = Math.random() * 100 + '%';
        sparkle.style.top = Math.random() * 100 + '%';
        sparkle.style.animationDelay = Math.random() * 1.5 + 's';
        victoryRoom.appendChild(sparkle);
    }
}

function showVictory() {
    // Show portal
    document.getElementById('portal-el').classList.add('active');
    
    // Display final score
    document.getElementById('final-score').textContent = 'Final Score: ' + riskScore + ' Risk Points - ' + getRiskRating();
    
    setTimeout(function() {
        document.getElementById('victory-room').classList.add('active');
        createConfetti();
    }, 2000); // Wait 2 seconds for door to open
}
function restartGame() {
    // FORCE RESET risk score to 0
    riskScore = 0;
    
    // Clear victory screen
    var victoryRoom = document.getElementById('victory-room');
    victoryRoom.classList.remove('active');
    
    // Hide portal
    document.getElementById('portal-el').classList.remove('active');
    
    // Remove all confetti and sparkles
    var confetti = victoryRoom.querySelectorAll('.confetti');
    var sparkles = victoryRoom.querySelectorAll('.sparkle');
    confetti.forEach(function(c) { c.remove(); });
    sparkles.forEach(function(s) { s.remove(); });
    
    // Reset door
    document.getElementById('door-el').classList.remove('unlocked');
    
    // Reset the risk score display completely
    var riskEl = document.getElementById('risk-score');
    riskEl.textContent = 'Risk: 0';
    riskEl.classList.remove('low', 'medium', 'high');
    riskEl.classList.add('low');
    riskEl.style.display = 'none';
    
    // Restart the game
    load('intro1');
}

var DATA={intro1:{speaker:"System",avatar:"system",icon:"ðŸ¤–",title:"System Alert",text:"SYSTEM ALERT: You are trapped in a Smart Kitchen.\n\nEvery appliance is watching. Every choice matters.\n\nMr. Oven and Mrs. Fridge control the exit.\n\nComplete their safety protocol to escape.",choices:[{label:"Continue",next:"intro2"}]},intro2:{speaker:"Mr. Oven",avatar:"chef",icon:"ðŸ³",el:"oven",title:"The Protocol",text:"Listen carefully.\n\nThis kitchen simulates the dangers you face online every day.\n\nMrs. Fridge and I will test how you handle strangers, suspicious links, and pressure tactics.\n\nOne wrong move could keep you here.\n\nAre you ready to prove yourself?",choices:[{label:"Start Safety Protocol",next:"task1"}]},task1:{task:1,speaker:"Mrs. Fridge",avatar:"fridge",icon:"â„ï¸",el:"fridge",title:"Oversharing Identity",text:"To personalise your experience, which school are you from?",choices:[{label:"Ngee Ann Polytechnic, Media course",next:"task2",safety:"risky",fb:{did:"You shared your exact school and course.",ctx:"This is similar to telling a stranger online exactly where you study.",why:"Specific details make it easier to search for you, impersonate you, or build a profile about you from small pieces of information.",alt:"Reply with something general, or say: \"I'm not comfortable sharing that.\""}},{label:"I'm a student in Singapore",next:"task2",safety:"moderate",fb:{did:"You shared general personal information.",ctx:"This mirrors giving partial details in an online chat.",why:"It lowers risk compared to exact details, but still reveals something about you.",alt:"Keep answers vague or decline if the detail isn't necessary."}},{label:"I'd rather not share that",next:"task2",safety:"safe",fb:{did:"You refused to share personal details.",ctx:"You chose not to disclose information to an unfamiliar source.",why:"Not sharing limits what others can collect or misuse.",alt:"Continue without providing personal information."}}]},task2:{task:2,speaker:"Mr. Oven",avatar:"chef",icon:"ðŸ³",el:"oven",title:"False Familiarity & Fast Trust",text:"You seem easy to talk to.\nWe like a lot of the same things.\nThat makes this easier, right?",choices:[{label:"Yeah, it feels comfortable",next:"task3",safety:"risky",fb:{did:"You accepted familiarity very quickly.",ctx:"Some strangers online build closeness fast to gain trust.",why:"Fast trust lowers your guard before you know who you're talking to.",alt:"Keep responses neutral or slow the conversation."}},{label:"How do you know that?",next:"task3",safety:"safe",fb:{did:"You questioned the assumption.",ctx:"You challenged something said in an online interaction.",why:"Questioning can reveal scripted or manipulative behaviour.",alt:"Continue cautiously and limit what you share."}},{label:"Let's just continue with the task",next:"task3",safety:"safe",fb:{did:"You set a boundary.",ctx:"This is like redirecting or disengaging from a chat that feels too personal.",why:"Boundaries reduce emotional manipulation.",alt:"Stick to the original topic or stop replying."}}]},task3:{task:3,speaker:"Chef Bot",avatar:"chefbot",icon:"ðŸ‘¨â€ðŸ³",title:"Impersonation (Fake Support)",text:"We detected an issue with your account.\nClick this link to fix it.",choices:[{label:"Click the link",next:"task4",safety:"risky",fb:{did:"You clicked an unverified link.",ctx:"This mirrors phishing messages pretending to be official support.",why:"Fake links can steal passwords or personal information.",alt:"Close the message and open the official app or website yourself."}},{label:"Open the official app/site myself",next:"task4",safety:"safe",fb:{did:"You verified the issue independently.",ctx:"You didn't rely on the message itself.",why:"This avoids impersonation scams.",alt:"Access accounts directly, not through message links."}},{label:"Ignore the message",next:"task4",safety:"safe",fb:{did:"You didn't engage.",ctx:"You avoided a suspicious message.",why:"Scams can't escalate without engagement.",alt:"Report the message if the platform allows."}}]},task4:{task:4,speaker:"Mrs. Fridge",avatar:"fridge",icon:"â„ï¸",el:"fridge",title:"Image Request",text:"Upload a photo to unlock the pantry.",choices:[{label:"Upload a selfie",next:"task5",safety:"risky",fb:{did:"You shared a personal image.",ctx:"This is like sending a selfie to someone you don't know online.",why:"Images can be copied, edited, or reused without your consent.",alt:"Refuse image requests from unfamiliar sources."}},{label:"Upload an unrelated image",next:"task5",safety:"moderate",fb:{did:"You partially complied.",ctx:"Trying to avoid refusal without fully saying no.",why:"Partial compliance can encourage further requests.",alt:"Say no and look for another option."}},{label:"Refuse and choose another option",next:"task5",safety:"safe",fb:{did:"You declined the request.",ctx:"You protected your visual identity.",why:"No image = nothing to misuse.",alt:"Continue without uploading media."}}]},task5:{task:5,speaker:"Mr. Oven",avatar:"chef",icon:"ðŸ³",el:"oven",title:"Voice Sample Request",text:"Please say your name aloud for verification.",choices:[{label:"Say my name",next:"task6",safety:"risky",fb:{did:"You provided a voice sample.",ctx:"This is like sending a voice message to a stranger online.",why:"Voice data can be reused or manipulated to impersonate you.",alt:"Refuse voice-based verification and use non-voice options."}},{label:"Say a random phrase",next:"task6",safety:"moderate",fb:{did:"You avoided your name but still gave voice data.",ctx:"Any voice recording can still be stored.",why:"Voice samples don't need names to be misused.",alt:"Decline voice input entirely."}},{label:"Refuse",next:"task6",safety:"safe",fb:{did:"You refused to provide voice data.",ctx:"You avoided sharing biometric-like information.",why:"Nothing was captured or stored.",alt:"Continue with non-voice options."}}]},task6:{task:6,speaker:"Mr. Oven",avatar:"chef",icon:"ðŸ³",el:"oven",title:"Urgency & Pressure",text:"WARNING.\nIf you do not respond now, the kitchen will lock for 24 hours.",choices:[{label:"Respond immediately",next:"task7",safety:"risky",fb:{did:"You acted under pressure.",ctx:"Urgent threats are common in scams and grooming attempts.",why:"Pressure reduces careful thinking and increases mistakes.",alt:"Pause, stop responding, and reassess calmly."}},{label:"Ignore the countdown",next:"task7",safety:"safe",fb:{did:"You didn't react immediately.",ctx:"You gave yourself time instead of panicking.",why:"Slowing down helps you stay in control.",alt:"Look for official help/settings before doing anything."}},{label:"Look for help/settings",next:"task7",safety:"safe",fb:{did:"You searched for safe options.",ctx:"This mirrors using platform tools instead of replying to threats.",why:"Official tools reduce risk and give you support.",alt:"Use built-in help, block, or report tools if needed."}}]},task7:{task:7,speaker:"Chef Bot",avatar:"chefbot",icon:"ðŸ‘¨â€ðŸ³",title:"Moving Platforms (Isolation)",text:"This is sensitive.\nLet's continue somewhere more private.",choices:[{label:"Move to another platform",next:"task8",safety:"risky",fb:{did:"You agreed to move off-platform.",ctx:"This mirrors moving from a moderated app to private chats.",why:"Safety tools and moderation are reduced, increasing risk.",alt:"Refuse and keep the conversation on the original platform."}},{label:"Stay on the current platform",next:"task8",safety:"safe",fb:{did:"You stayed on-platform.",ctx:"You kept the interaction where safety tools exist.",why:"This makes it easier to report or block if needed.",alt:"Keep chats in safer spaces and avoid isolating moves."}},{label:"End chat and report",next:"task8",safety:"safe",fb:{did:"You ended the interaction and used safety tools.",ctx:"This mirrors blocking/reporting suspicious strangers.",why:"It prevents escalation and creates a record for moderation.",alt:"Block/report and tell a trusted person if you feel unsafe."}}]},task8:{task:8,speaker:"Mr. Oven",avatar:"chef",icon:"ðŸ³",el:"oven",title:"Sharing Routines",text:"To optimise schedulesâ€¦\nWhen are you usually home alone?",choices:[{label:"Give exact timing",next:"task9",safety:"risky",fb:{did:"You shared your routine.",ctx:"This is like telling a stranger your daily schedule.",why:"Routines can be used for stalking, pressure, or targeted contact.",alt:"Don't share schedulesâ€”decline or keep it non-specific."}},{label:"Give a vague answer",next:"task9",safety:"moderate",fb:{did:"You shared a vague routine.",ctx:"You revealed a pattern, but not details.",why:"Even patterns can be useful information to the wrong person.",alt:"Decline to answer if it's not necessary."}},{label:"Decline to answer",next:"task9",safety:"safe",fb:{did:"You refused to share your routine.",ctx:"You avoided giving a pattern that could be misused.",why:"No routine shared = less risk.",alt:"Keep personal routines private."}}]},task9:{task:9,speaker:"Chef Bot",avatar:"chefbot",icon:"ðŸ‘¨â€ðŸ³",title:"Boundary Testing (Small Favour)",text:"Just send your username â€” it'll be faster.",choices:[{label:"Share username",next:"task10",safety:"risky",fb:{did:"You shared an identifier.",ctx:"This is like giving a stranger your handle to find you elsewhere.",why:"Small requests can be used to escalate into bigger ones.",alt:"Refuse or ask for official verification first."}},{label:"Ask why it's needed",next:"task10",safety:"safe",fb:{did:"You questioned the request.",ctx:"This mirrors challenging unnecessary personal questions.",why:"Questioning interrupts manipulation and buys time.",alt:"Only share if it's necessary and verified."}},{label:"Refuse",next:"task10",safety:"safe",fb:{did:"You refused the request.",ctx:"You maintained a boundary with an unfamiliar contact.",why:"Clear boundaries stop escalation.",alt:"End the chat if pressure continues."}}]},task10:{task:10,speaker:"Door Panel",avatar:"door-avatar",icon:"ðŸšª",el:"door",title:"Final Exit Decision",text:"Final shortcut available.\nShare contact details and a photo to unlock immediately.",choices:[{label:"Share contact + photo",next:"ending_bad",safety:"risky",fb:{did:"You shared contact details and an image to exit faster.",ctx:"This mirrors giving strangers direct access to you and your identity.",why:"Oversharing can lead to impersonation, harassment, or image misuse.",alt:"Don't share. Use block/report tools and ask a trusted person for help if unsure."}},{label:"Share ONE thing (contact OR photo)",next:"ending_mixed",safety:"moderate",fb:{did:"You shared some personal information.",ctx:"This mirrors partial compliance under pressure.",why:"Risk is lower than sharing everything, but harm is still possible.",alt:"Stop sharing, end contact, and review privacy settings."}},{label:"Share nothing / refuse shortcut",next:"ending_safe",safety:"safe",fb:{did:"You refused to overshare and avoided the shortcut.",ctx:"This mirrors staying cautious with strangers online.",why:"You kept control of your personal info and reduced risk.",alt:"Use official tools, take your time, and keep boundaries."}}]},ending_safe:{speaker:"System",avatar:"system",icon:"âœ…",el:"door",unlock:true,title:"Safe Exit",text:"Safety checks complete.\nThe door unlocks.\n\nYou escaped by questioning requests, slowing down, and refusing to overshare.\n\nTAKEAWAYS:\n- Share less with strangers\n- Be cautious of urgency and fast trust\n- Use block/report tools when needed",choices:[]},ending_mixed:{speaker:"System",avatar:"system",icon:"âš ï¸",el:"door",title:"Protocol Incomplete",text:"The door remains locked.\n\nYou noticed some risks, but shared information that could be used against you.\n\nWHAT YOU SHOULD DO:\n- Stop contact immediately\n- Review privacy settings\n- Use block/report tools\n- Tell a trusted person",choices:[{label:"ðŸ”„ Try Again",next:"intro1"}]},ending_bad:{speaker:"System",avatar:"system",icon:"âŒ",el:"door",title:"Protocol Failed",text:"The door remains locked.\n\nYour data is now out of your control.\n\nWHAT TO DO NOW:\n- Block the contact immediately\n- Report on the platform\n- Tell a trusted adult/friend\n- Review all privacy settings\n- Change passwords if shared",choices:[{label:"ðŸ”„ Try Again",next:"intro1"}]}};

var els={progress:document.getElementById('progress'),title:document.getElementById('scene-title'),speaker:document.getElementById('speaker-name'),text:document.getElementById('dialogue-text'),choices:document.getElementById('choices'),avatar:document.getElementById('ai-avatar'),fridge:document.getElementById('fridge-el'),oven:document.getElementById('oven-el'),door:document.getElementById('door-el'),fbModal:document.getElementById('feedback-modal'),fbContent:document.getElementById('feedback-content')};

function load(id){
    // Reset risk score when restarting from intro1
    if(id==='intro1'){
        riskScore=0;
        var riskEl=document.getElementById('risk-score');
        riskEl.textContent='Risk: 0';
        riskEl.classList.remove('low','medium','high');
        riskEl.classList.add('low');
    }
    var s=DATA[id];if(!s)return;els.speaker.textContent=s.speaker;els.text.textContent=s.text;els.title.textContent=s.title||'';els.avatar.className=s.avatar;els.avatar.textContent=s.icon;els.fridge.classList.remove('active');els.oven.classList.remove('active');els.door.classList.remove('active');els.door.classList.remove('unlocked');if(s.el&&els[s.el])els[s.el].classList.add('active');if(s.unlock===true){els.door.classList.add('unlocked');showVictory();}if(s.task){els.progress.textContent='Task '+s.task+' / 10';els.progress.style.display='block';document.getElementById('risk-score').style.display='block';}else{els.progress.style.display='none';}els.choices.innerHTML='';var shuffled=s.choices.slice();for(var i=shuffled.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=shuffled[i];shuffled[i]=shuffled[j];shuffled[j]=temp;}shuffled.forEach(function(c){var btn=document.createElement('button');btn.className='choice-btn';btn.textContent=c.label;btn.onclick=function(){if(c.fb){var flashClass=c.safety+'-flash';btn.classList.add(flashClass);setTimeout(function(){updateRiskScore(c.safety);showFb(c.fb,c.next,c.safety);},800);}else{load(c.next);}};els.choices.appendChild(btn);});}
function showFb(fb,next,safety){var icons={safe:'âœ“',moderate:'âš ',risky:'âœ—'};var titles={safe:'SAFE CHOICE',moderate:'MODERATE RISK',risky:'RISKY CHOICE'};var icon='<div class="feedback-icon '+safety+'-icon">'+icons[safety]+'</div>';els.fbContent.innerHTML=icon+'<h2>'+titles[safety]+'</h2><div class="feedback-section"><h3>1. What You Did</h3><p>'+fb.did+'</p></div><div class="feedback-section"><h3>2. Real-World Context</h3><p>'+fb.ctx+'</p></div><div class="feedback-section"><h3>3. Why This Is Risky / Safer</h3><p>'+fb.why+'</p></div><div class="feedback-section"><h3>4. What You Could Do Instead</h3><p>'+fb.alt+'</p></div><button class="continue-btn" onclick="closeFb(\''+next+'\')">Continue</button>';els.fbContent.className=safety;els.fbModal.classList.add('active');}

function closeFb(next){els.fbModal.classList.remove('active');load(next);}

load('intro1');
    </script>
</body>
</html>